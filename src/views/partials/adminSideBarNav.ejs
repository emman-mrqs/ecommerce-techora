<head>
  <link rel="stylesheet" href="/css/adminSideBarNav.css">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="/js/adminSideBarNav.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Make sure your page already includes Bootstrap JS bundle somewhere (for dropdown) -->
</head>

<!-- Sidebar Overlay (mobile only) -->
<div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

<!-- Sidebar -->
<div class="sidebar" id="sidebar">
  <div class="p-3">
    <!-- Logo -->
    <div class="d-flex align-items-center mb-4">
      <div class="me-2" style="background:#111;width:32px;height:32px;border-radius:4px;display:flex;align-items:center;justify-content:center;">
        <a href="/admin"><span style="color:#fff;font-weight:bold;font-size:14px;">A</span></a>
      </div>
      <a href="/admin"><span style="color:#fff;font-weight:bold;">ADMIN PANEL</span></a>
    </div>

    <!-- Nav Links -->
    <nav class="nav flex-column">
      <a class="nav-link <%= activePage === 'dashboard' ? 'active' : '' %>" href="/admin">
        <i class="fas fa-chart-line"></i> Dashboard
      </a>
      <a class="nav-link <%= activePage === 'users' ? 'active' : '' %>" href="/admin/users">
        <i class="fas fa-users"></i> Users
      </a>
      <a class="nav-link <%= activePage === 'sellers' ? 'active' : '' %>" href="/admin/sellers">
        <i class="fas fa-store"></i> Sellers
      </a>
      <a class="nav-link <%= activePage === 'products' ? 'active' : '' %>" href="/admin/products">
        <i class="fas fa-box"></i> Products
      </a>
      <a class="nav-link <%= activePage === 'orders' ? 'active' : '' %>" href="/admin/orders">
        <i class="fas fa-shopping-cart"></i> Orders
      </a>
      <a class="nav-link <%= activePage === 'earnings' ? 'active' : '' %>" href="/admin/earnings">
        <i class="fas fa-credit-card"></i> Earnings
      </a>
      <a class="nav-link <%= activePage === 'promotions' ? 'active' : '' %>" href="/admin/promotions">
        <i class="fas fa-tags"></i> Promotions
      </a>
      <a class="nav-link <%= activePage === 'analytics' ? 'active' : '' %>" href="/admin/analytics">
        <i class="fas fa-chart-bar"></i> Analytics
      </a>
      <a class="nav-link <%= activePage === 'cms' ? 'active' : '' %>" href="/admin/cms">
        <i class="fas fa-file-alt"></i> CMS
      </a>
      <a class="nav-link <%= activePage === 'settings' ? 'active' : '' %>" href="/admin/settings">
        <i class="fas fa-cog"></i> Settings
      </a>
      <a class="nav-link <%= activePage === 'audit' ? 'active' : '' %>" href="/admin/audit">
        <i class="fas fa-shield-alt"></i> Audit Logs
      </a>
    </nav>
  </div>
</div>

<!-- Top Header -->
<div class="top-header d-flex justify-content-between align-items-center">
  <div class="d-flex align-items-center">
    <!-- Mobile hamburger -->
    <button class="mobile-menu-btn me-3" onclick="toggleSidebar()">
      <i class="fas fa-bars"></i>
    </button>
    <!-- Dynamic Title -->
    <span class="fw-bold"><%= pageTitle %></span>
  </div>

  <% 
    const adminEmail = (typeof admin !== 'undefined' && admin && admin.email) ? admin.email : null;
    const adminInitials = adminEmail ? adminEmail.slice(0,2).toUpperCase() : 'AD';
  %>
  <div class="user-actions d-flex align-items-center gap-3">
  <!-- Notification -->
  <div class="dropdown me-2">
    <button
      class="btn btn-link text-decoration-none position-relative"
      id="notificationDropdown"
      data-bs-toggle="dropdown"
      aria-expanded="false"
    >
      <i class="fas fa-bell fs-5 text-muted"></i>
      <span
        id="notifCount"
        class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger d-none"
        style="font-size: 0.6rem;"
      ></span>
    </button>

    <ul class="dropdown-menu dropdown-menu-end shadow p-0" aria-labelledby="notificationDropdown" style="width: 320px; max-height: 400px; overflow-y: auto;">
      <li class="dropdown-header bg-light fw-semibold p-2 d-flex justify-content-between align-items-center">
        Notifications
        <button id="markAllBtn" class="btn btn-sm btn-outline-secondary py-0 px-2">Mark All Read</button>
      </li>
      <div id="notifList"></div>
      <li id="noNotif" class="dropdown-item text-muted text-center py-3 small d-none">
        No new notifications
      </li>
    </ul>
  </div>


    <!-- Avatar + dropdown -->
    <div class="dropdown">
      <button class="btn btn-light d-flex align-items-center gap-2 px-2 py-1" data-bs-toggle="dropdown" aria-expanded="false">
        <div class="avatar"><%= adminInitials %></div>
        <i class="fa-solid fa-chevron-down small text-muted"></i>
      </button>
      <ul class="dropdown-menu dropdown-menu-end shadow">
        <li class="dropdown-header small">
          <div class="fw-semibold"><%= adminEmail || 'Admin' %></div>
        </li>
        <li><a class="dropdown-item" href="/admin"><i class="fa-solid fa-gauge-high me-2"></i>Dashboard</a></li>
        <li><hr class="dropdown-divider"></li>
        <li>
          <a class="dropdown-item text-danger" href="/admin/logout">
            <i class="fa-solid fa-right-from-bracket me-2"></i> Logout
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>
